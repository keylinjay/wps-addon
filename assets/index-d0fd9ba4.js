import{a2 as M,a3 as X,a4 as Y,f as Z,o as ee,j as te,w as C,k as A,l as O,a5 as oe,n as Q,m as se,v as re,A as le}from"./index-267d7a3c.js";const H={nodeName:null,isItemizedProject:!1,isNeedCount:!0,isSumBefore:!1},L={rowIndex:null,orderNumber:null,itemIdentifier:null,itemName:null,itemSpecs:null,itemUnit:null,itemQuantity:null,itemUnitPrice:null,itemSumPrice:null};let $={},k={},b={};class S{constructor(e,o=L){typeof e=="string"&&(e={nodeName:e}),Object.keys(H).forEach(t=>{e[t]!==void 0?this[t]=e[t]:this[t]=H[t]}),Object.keys(L).forEach(t=>{o[t]!==void 0?this[t]=o[t]:this[t]=L[t]}),this.hasSpecialRow=!1,this.isComputedFlag=!1,this.nodeLv=0,this.childrenNode=[],this.parentNode=null}updateNodeLv(){this.parentNode===null?this.nodeLv=0:(this.nodeLv=this.parentNode.nodeLv+1,this.childrenNode.forEach(e=>{e.updateNodeLv()}))}addChild(e){return this.childrenNode.push(e),e.parentNode=this,this.updateNodeLv(),this}addAndGetNewChild(e){return this.addChild(e),e}findChildNode(e){return this.childrenNode.forEach(o=>{if(o.nodeName===e)return o}),null}match(e,o){if(this[e]===null||this[e]===void 0)return!1;let t,l;t=this[e].replace(/[^\w\s\u4e00-\u9fa5]/g,"").trim(),l=o;let a="m",s=$[l];return s||(s=new RegExp("^.*".concat(l,".*$"),a),$[l]=s),t===l?!0:!!s.test(t)}querySelector(e,o=!1){function t(r){for(var i=r.split(">"),m=[],u=0;u<i.length;u++){let c=i[u].trim();if(k[c]){m.push(k[c]);continue}var K=c.split("&"),f={};K.forEach(y=>{let R=y.split("=")[0].trim(),W=y.split("=")[1].replace(/"/g,"").trim();f[R]=W}),k[c]=f,m.push(f)}return m}function l(r,i){const m=Object.keys(i);function u(f){let c=!0;return m.some(y=>{if(!f.match(y,i[y]))return c=!1,!0}),c}if(u(r))return r;if(r.childrenNode&&r.childrenNode.length>0)for(var K=0;K<r.childrenNode.length;K++){let f=null;if(o?f=l(r.childrenNode[K],i):u(r.childrenNode[K])&&(f=r.childrenNode[K]),f)return f}return null}const a=t(e);let s=this,d="";for(let r=0;r<a.length;r++){let i=a[r];if(d=d+JSON.stringify(i),b[d]){s=b[d];continue}else if(b[d]===null){s=null;break}if(s=l(s,i),b[d]=s,!s)break}return s}querySelectorAll(e,o=!0){function t(r){for(var i=r.split(">"),m=[],u=0;u<i.length;u++){var K=i[u].trim().split("&"),f={};K.forEach(c=>{let y=c.split("=")[0].trim(),R=c.split("=")[1].replace(/"/g,"").trim();f[y]=R}),m.push(f)}return m}function l(r,i){const m=Object.keys(i),u=[];function K(c){let y=!0;return m.some(R=>{if(!c.match(R,i[R]))return y=!1,!0}),y}function f(c){if(c&&(K(c)&&u.push(c),c.childrenNode&&c.childrenNode.length>0))for(var y=0;y<c.childrenNode.length;y++)f(c.childrenNode[y])}return o&&f(r),u}const a=t(e);let s=[this],d=[];for(let r=0;r<a.length;r++){d=[];for(let i=0;i<s.length;i++){let m=s[i],u=l(m,a[r]);if(!u)return null;d.push(...u)}s=d}return d}getValue(e,o){let t=this.querySelector(e);return t?t[o]:null}generateData(e,o){const t={};for(let l=0;l<e.length;l++){let a=e[l],s=a.sheetName;t[s]={};let d=a.cells;Object.keys(d).forEach(r=>{let i=0,m=d[r].attribute;d[r].selectors.forEach(u=>{let K=this.getValue(u,m);i+=Number(K),o()}),t[s][r]=i})}return console.log("resultData is:",t),t}updateComputedSumPrice(){if(this.isItemizedProject)if(this.isSumBefore)this.computedSumPrice=this.parentNode.childrenNode.reduce((e,o)=>(o.isNeedCount&&o.isComputedFlag&&(e=e+o.computedSumPrice),e),0),this.isComputedFlag=!0;else{let e=this.itemQuantity*this.itemUnitPrice;e===0?this.computedSumPrice=this.itemSumPrice:this.computedSumPrice=e,this.isComputedFlag=!0}else this.computedSumPrice=this.childrenNode.reduce((e,o)=>{let t=o.updateComputedSumPrice().computedSumPrice;return o.isNeedCount&&(e=e+t),e},0),this.isComputedFlag=!0;return this}updateComputedSumPriceOld(){return this.isItemizedProject?this.computedSumPrice=this.itemQuantity*this.itemUnitPrice:this.computedSumPrice=this.childrenNode.reduce((e,o)=>(e+=o.updateComputedSumPriceOld().computedSumPrice,e),0),this}initCache(){return $={},k={},b={},this}}function ie(h,e,o){const t={};for(let l=0;l<e.length;l++){let a=e[l],s=a.sheetName;t[s]={};let d=a.cells;Object.keys(d).forEach(r=>{let i=0,m=d[r].attribute;d[r].selectors.forEach(u=>{let K=h.getValue(u,m);console.log(u,"找到的value值是:",K),i+=Number(K)}),o&&o(),t[s][r]=i})}return console.log("resultData is:",t),t}const N={建筑:"建筑",装饰:"装饰",土建室外:"土建室外",暖通设备:"暖通设备",暖通:"暖通(?!设)",动力设备:"动力设备",动力:"动力(?!设)",给排水设备:"给排水设(备)?",给排水:"给排水(?!设)",供电设备:"供电设备",供电:"供电(?!设)",电照设备:"电照设备",电照:"电照(?!设)",通信设备:"通信设备",通信:"通信(?!设)",电梯:"电梯",系统工程:"系统工程",自控:"(?<!、)自控"},w=[];w.update=h=>{function e(o){let t=null,l="m",a=new RegExp("^.*".concat(o,".*$"),l),s=h.Worksheets;for(let d=1;d<=s.Count;d++){let r=s.Item(d).Name;if(a.test(r))return console.log("找到了工作表".concat(r)),t=r,t}return t}return w.filter(o=>{let t=e(o.sheetNameKeyWords);return t?(o.sheetName=t,o.rowIndex.end=h.Worksheets.Item(t).Range("B10000").End(-4162).Row,console.log("本工作表的最后有效数据行为".concat(o.rowIndex.end)),!0):(console.warn("工作表中未找到能匹配 ".concat(o.sheetNameKeyWords," 的sheet表")),!1)})};w.push({sheetNameKeyWords:N.建筑,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"",itemUnit:"C",itemQuantity:"D",itemUnitPrice:"E",itemSumPrice:"F"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合费用","税金"],totalKeyWords:["小计","合计","工程造价"]}},lv2:{lvKeyWords:["土石方工程","地基处理与边坡支护工程","桩基工程","基础工程","地下室及地下防水工程","砌筑工程","混凝土与钢筋混凝土工程(（不含地下）)?","金属结构工程","屋面及防水工程","建筑其他系统"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:["屋面"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.装饰,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"",itemUnit:"C",itemQuantity:"D",itemUnitPrice:"E",itemSumPrice:"F"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["非洁净","(?<!非)洁净"],specialRow:{costKeyWords:["零星","费用","税金"],totalKeyWords:["小计","合计","工程造价"]}},lv3:{lvKeyWords:["楼地面","隔墙","外墙","(墙)?(、)?(柱)?面","天棚","门窗","其他"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.土建室外,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"F",itemSumPrice:"G"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:["道路","构筑物","围墙","绿化","其他","土方","其他"],specialRow:{costKeyWords:["零星","综合","税金"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.暖通设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置费","安装费"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["一般空调","洁净空调","通风","排烟"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.暖通,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["空调风","通风","排烟","空调水"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.动力设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["冷冻水","热水","蒸汽","柴油"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.动力,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["冷冻水","热水","蒸汽","柴油"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.给排水设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["给排水","消防"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["给水","排水","消火栓","自(动)?喷","气(体)?灭"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.给排水,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["(?<!室外)给排水","(?<!室外)消防"],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["给水","(?<!给)排水","雨水","消火栓","自(动)?喷","气(体)?灭"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.供电设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.供电,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.电照设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["动力","照明","消防","火灾(漏电)?监控"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.电照,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["动力","照明"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.通信设备,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["通信","消防"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["综合布线","有线电视","安防","视频会议","控制中心","广播","报警","采样"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.通信,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["通信","消防"],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["综合布线","有线电视","安防","视频会议","控制中心","广播","报警","采样"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.电梯,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"F",itemSumPrice:"G"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["非洁净","(?<!非)洁净"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.系统工程,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["工程合计","小计"]}},lv2:{lvKeyWords:["设备","材料"],specialRow:{costKeyWords:["运杂","购置","安装","综合"],totalKeyWords:["小计","(?<!工程)合计","总计"]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});w.push({sheetNameKeyWords:N.自控,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["工程合计","小计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});function E(h){return h=h.replace(/[^\w\s\u4e00-\u9fa5]/g,"").trim(),h}const j={sheetName:"表2",cells:{C23:{range:"C23",row:23,column:3,selectors:["nodeName=土建室外"],attribute:"computedSumPrice"},E24:{range:"E24",row:24,column:5,selectors:["nodeName=给排水(?!设)>itemName=室外给排水工程","nodeName=给排水(?!设)>itemName=室外消防（水）工程"],attribute:"computedSumPrice"},G25:{range:"G25",row:25,column:7,selectors:["nodeName=动力(?!设)>itemName=室外动力"],attribute:"computedSumPrice"},H26:{range:"H26",row:26,column:8,selectors:["nodeName=供电(?!设)>itemName=室外"],attribute:"computedSumPrice"},J27:{range:"J27",row:27,column:10,selectors:["nodeName=通信(?!设)>itemName=室外工程"],attribute:"computedSumPrice"}},update:function(h){let e=6,o="B",t={start:8,end:19},l={start:"C",end:"K"},a=h.Worksheets.Item(j.sheetName);for(let s=t.start;s<=t.end;s++)for(let d=l.start.charCodeAt();d<=l.end.charCodeAt();d++){let r=s,i=String.fromCharCode(d),m="nodeName="+E(a.Range(i+e).Value2)+"(?!设)",u="itemName="+E(a.Range(o+r).Value2),K=m+">"+u;this.cells[i+r]={selectors:[K],attribute:"computedSumPrice"}}return console.log("report2 is :",j),j}},_={sheetName:"表3",cells:{},update:function(h){let e=6,o="B",t={start:8,end:19},l={start:"C",end:"T"},a=h.Worksheets.Item(_.sheetName);for(let s=t.start;s<=t.end;s++)for(let d=l.start.charCodeAt();d<=l.end.charCodeAt();d++){let r=s,i=String.fromCharCode(d),m=a.Range(i+(e-1)).Value2,u=d;for(;!m;)m=a.Range(String.fromCharCode(u--)+(e-1)).Value2;let K=a.Range(o+r).Value2,f=a.Range(i+e).Value2;f.includes("安装")?f="设备安装费":f="设备购置费";let c="nodeName="+E(m)+"(?!设)",y="itemName="+E(K),R="itemName="+f,W=c+">"+y+">"+R;this.cells[i+r]={selectors:[W],attribute:"computedSumPrice"}}return console.log("report3 is :",_),_}},U={sheetName:"表4",cells:{},update:function(h){let e="B",o={start:7,end:20},t={start:"C",end:"C"},l=h.Worksheets.Item(U.sheetName);for(let a=o.start;a<=o.end;a++)for(let s=t.start.charCodeAt();s<=t.end.charCodeAt();s++){let d=a,r=String.fromCharCode(s),i="系统工程",m=l.Range(e+d).Value2,u="nodeName="+E(i)+"(?!设)",K="itemName="+m,f=u+">"+K;U.cells[r+d]={selectors:[f],attribute:"computedSumPrice"}}return console.log("report4 is :",U),U}},de=[j,_,U];function ae(h,e,o){let t=h.Worksheets,l;Object.keys(e).forEach(a=>{l=t.Item(a),Object.keys(e[a]).forEach(s=>{console.log("正在填写",a,s,e[a][s]),o&&o(),l.Range(s).Value2=e[a][s]})})}function ne(h,e){if(e===void 0||typeof e!="object"){console.error("请传为loadDataByRows入正确的参数options");return}const o=(W,n)=>!!(!l(W,e.columnIndex.itemName+n)&&l(W,e.columnIndex.itemUnit+n)),t=(W,n)=>!(l(W,e.columnIndex.itemName+n)&&l(W,e.columnIndex.itemSpecs+n))&&!l(W,e.columnIndex.itemUnit+n),l=(W,n)=>{let v=W.Range(n);if(v===null)return console.info("当前单元格".concat(n,"不存在！按空值处理！")),!0;let p=v.Value();if(typeof p=="string")return p.trim()==="";if(typeof p=="number")return p===0;if(typeof p=="object")return p===null};function a(W,n){let v={rowIndex:n};return Object.keys(e.columnIndex).forEach(p=>{e.columnIndex[p]?v[p]=W.Range(e.columnIndex[p]+n).Value():v[p]=null}),v}function s(W,n,v,p=0){let g=1;return Object.keys(W).some((x,D)=>{let I=D+1;if(p===0){if(m(W[x][n],v))return g=I,!0}else if(I=p&&m(W[x][n],v))return g=I,!0;return!1}),v==="室外给排水工程"&&console.log("".concat(n,"中找到的分级为").concat(g)),g}function d(W,n,v=e.section){let p=Object.keys(v),g=Object.keys(v[p[0]].specialRow);n===void 0&&(n=p.length);let P=0,x=!1,D=!1;for(let I=n-1;I>=0;I--){let G=p[I],z=v[G].specialRow;if(P=I+1,g.some((q,J)=>m(z[q],W)?(J===1&&(x=!0),D=!0,!0):!1))break}return{lv:P+1,isSpecialRow:D,isTotalRow:x}}function r(W,n){let v=Object.keys(n),p=Object.keys(n[v[0]])[0];return s(n,p,W)}let i={};function m(W,n){return n?(n=String(n).replace(/\s/g,""),W.some(v=>{v=v.replace(/\s/g,"");let p=i[v];if(!p){let g="m";p=new RegExp("^.*".concat(v,".*$"),g),i[v]=p}return p.test(n)})):!1}const u=e.sheetName;if(!u)return new S("no-sheetname");const K=h.Worksheets.Item(u);let f=e.section,c=new S(u),y=[c],R=1;for(let W=e.rowIndex.start;W<=e.rowIndex.end;W++){let n=a(K,W);if(t(K,W)){let v=d(n.itemName,R),{lv:p,isSpecialRow:g,isTotalRow:P}=v;if(g){for(;y.length>p;)y.pop();c=y[y.length-1],P?c.addAndGetNewChild(new S({nodeName:"统计行",isItemizedProject:!0,isNeedCount:!1,isSumBefore:!0},n)):c.addAndGetNewChild(new S({nodeName:"费用行",isItemizedProject:!0},n))}else c.addAndGetNewChild(new S({nodeName:"清单行",isItemizedProject:!0},n))}else if(o(K,W))if(R=r(n.itemName,f),R===y.length)c=y[y.length-1],c=c.addAndGetNewChild(new S("分部行",n)),y.push(c);else{for(;y.length>R;)y.pop();c=y[y.length-1],c=c.addAndGetNewChild(new S("分部行",n)),y.push(c)}}return y[0]}const ce=M("progress",{state:()=>({percentage:0,spendTime:0}),actions:{increment(){this.percentage++}}});function T(){return ce(X)}const V=T(),F=(()=>typeof wps<"u")(),B=F?Application:window;function ue(){if(F){let h=w.update(B);if(console.log("更新后的options",h),!h.length){alert("请在世源通用概算表中运行此功能！");return}let e=new Date,o=e.getTime();const t=new S("概算");t.initCache(),h.forEach(u=>{let K=ne(B,u);K.updateComputedSumPrice(),t.addChild(K)}),e=new Date;let l=e.getTime();const a=de.map(u=>u.update(B));let s=0,d=ie(t,a,()=>{console.log(s++)});e=new Date;let r=e.getTime(),i=0;ae(B,d,()=>{i++,V.percentage=i/s*100,console.log(i,"/",s,"progress.percentage is",V.percentage)}),e=new Date;let m=e.getTime();console.log("本次收集数据运行时间为：".concat((l-o)/1e3,"秒")),console.log("本次查询数据运行时间为：".concat((r-l)/1e3,"秒")),console.log("本次填写数据运行时间为：".concat((m-r)/1e3,"秒")),console.log("共计运行时间为：".concat((m-o)/1e3,"秒")),V.spendTime=(m-o)/1e3,console.log(t)}else alert("请在wps中运行!")}const me={__name:"index",setup(h){const e=T();Z(()=>{if(e.percentage===100)return"success";if(e.percentage!==100)return"default"});function o(){e.percentage=0,setTimeout(()=>{ue(),$message.info("本次共计用时".concat(e.spendTime,"秒。"))},100)}return(t,l)=>(ee(),te(A(le),null,{default:C(()=>[O(A(re),{justify:"space-evenly"},{default:C(()=>[O(A(oe),{embedded:"",title:"概算报表",segmented:{content:!0,footer:"soft"},"header-style":"text-align: center","header-extra-style":"text-align: center","footer-style":"text-align: center"},{"header-extra":C(()=>[Q(" 自动化辅助")]),footer:C(()=>[O(A(se),{strong:"",secondary:"",type:"info",onClick:o},{default:C(()=>[Q("填写概算报表")]),_:1})]),action:C(()=>[]),default:C(()=>[Q(" 功能：自动汇总概算表里的表1，表2，表3和表4。希望这能让你早点下班。 ")]),_:1})]),_:1})]),_:1}))}},Ke=Y(me,[["__scopeId","data-v-e92f834c"]]);export{Ke as default};
