System.register(["./index-legacy-9064cd94.js"],(function(e,t){"use strict";var o,s,r,l,i,d,n,c,a,m,y,u,W,K;return{setters:[e=>{o=e.a2,s=e.a3,r=e.a4,l=e.f,i=e.o,d=e.j,n=e.w,c=e.k,a=e.l,m=e.a5,y=e.n,u=e.m,W=e.v,K=e.A}],execute:function(){var t=document.createElement("style");t.textContent=".n-card[data-v-e92f834c]{max-width:300px}\n",document.head.appendChild(t);const p={nodeName:null,isItemizedProject:!1,isNeedCount:!0,isSumBefore:!1},v={rowIndex:null,orderNumber:null,itemIdentifier:null,itemName:null,itemSpecs:null,itemUnit:null,itemQuantity:null,itemUnitPrice:null,itemSumPrice:null};let h={},w={},f={};class N{constructor(e,t=v){"string"==typeof e&&(e={nodeName:e}),Object.keys(p).forEach((t=>{void 0!==e[t]?this[t]=e[t]:this[t]=p[t]})),Object.keys(v).forEach((e=>{void 0!==t[e]?this[e]=t[e]:this[e]=v[e]})),this.hasSpecialRow=!1,this.isComputedFlag=!1,this.nodeLv=0,this.childrenNode=[],this.parentNode=null}updateNodeLv(){null===this.parentNode?this.nodeLv=0:(this.nodeLv=this.parentNode.nodeLv+1,this.childrenNode.forEach((e=>{e.updateNodeLv()})))}addChild(e){return this.childrenNode.push(e),e.parentNode=this,this.updateNodeLv(),this}addAndGetNewChild(e){return this.addChild(e),e}findChildNode(e){return this.childrenNode.forEach((t=>{if(t.nodeName===e)return t})),null}match(e,t){if(null===this[e]||void 0===this[e])return!1;let o,s;o=this[e].replace(/[^\w\s\u4e00-\u9fa5]/g,"").trim(),s=t;let r=h[s];return r||(r=new RegExp(`^.*${s}.*$`,"m"),h[s]=r),o===s||!!r.test(o)}querySelector(e,t=!1){function o(e,s){const r=Object.keys(s);function l(e){let t=!0;return r.some((o=>{if(!e.match(o,s[o]))return t=!1,!0})),t}if(l(e))return e;if(e.childrenNode&&e.childrenNode.length>0)for(var i=0;i<e.childrenNode.length;i++){let r=null;if(t?r=o(e.childrenNode[i],s):l(e.childrenNode[i])&&(r=e.childrenNode[i]),r)return r}return null}const s=function(e){for(var t=e.split(">"),o=[],s=0;s<t.length;s++){let e=t[s].trim();if(w[e])o.push(w[e]);else{var r=e.split("&"),l={};r.forEach((e=>{let t=e.split("=")[0].trim(),o=e.split("=")[1].replace(/"/g,"").trim();l[t]=o})),w[e]=l,o.push(l)}}return o}(e);let r=this,l="";for(let i=0;i<s.length;i++){let e=s[i];if(l+=JSON.stringify(e),f[l])r=f[l];else{if(null===f[l]){r=null;break}if(r=o(r,e),f[l]=r,!r)break}}return r}querySelectorAll(e,t=!0){function o(e,o){const s=Object.keys(o),r=[];return t&&function e(t){if(t&&(function(e){let t=!0;return s.some((s=>{if(!e.match(s,o[s]))return t=!1,!0})),t}(t)&&r.push(t),t.childrenNode&&t.childrenNode.length>0))for(var l=0;l<t.childrenNode.length;l++)e(t.childrenNode[l])}(e),r}const s=function(e){for(var t=e.split(">"),o=[],s=0;s<t.length;s++){var r=t[s].trim().split("&"),l={};r.forEach((e=>{let t=e.split("=")[0].trim(),o=e.split("=")[1].replace(/"/g,"").trim();l[t]=o})),o.push(l)}return o}(e);let r=[this],l=[];for(let i=0;i<s.length;i++){l=[];for(let e=0;e<r.length;e++){let t=o(r[e],s[i]);if(!t)return null;l.push(...t)}r=l}return l}getValue(e,t){let o=this.querySelector(e);return o?o[t]:null}generateData(e,t){const o={};for(let s=0;s<e.length;s++){let r=e[s],l=r.sheetName;o[l]={};let i=r.cells;Object.keys(i).forEach((e=>{let s=0,r=i[e].attribute;i[e].selectors.forEach((e=>{let o=this.getValue(e,r);s+=Number(o),t()})),o[l][e]=s}))}return console.log("resultData is:",o),o}updateComputedSumPrice(){if(this.isItemizedProject)if(this.isSumBefore)this.computedSumPrice=this.parentNode.childrenNode.reduce(((e,t)=>t.isNeedCount&&t.isComputedFlag?e+=t.computedSumPrice:e),0),this.isComputedFlag=!0;else{let e=this.itemQuantity*this.itemUnitPrice;this.computedSumPrice=0===e?this.itemSumPrice:e,this.isComputedFlag=!0}else this.computedSumPrice=this.childrenNode.reduce(((e,t)=>{let o=t.updateComputedSumPrice().computedSumPrice;return t.isNeedCount?e+=o:e}),0),this.isComputedFlag=!0;return this}updateComputedSumPriceOld(){return this.isItemizedProject?this.computedSumPrice=this.itemQuantity*this.itemUnitPrice:this.computedSumPrice=this.childrenNode.reduce(((e,t)=>e+=t.updateComputedSumPriceOld().computedSumPrice),0),this}initCache(){return h={},w={},f={},this}}const R="建筑",g="装饰",I="土建室外",S="暖通设备",C="暖通(?!设)",P="动力设备",x="动力(?!设)",b="给排水设(备)?",U="给排水(?!设)",E="供电设备",A="供电(?!设)",k="电照设备",B="电照(?!设)",D="通信设备",j="通信(?!设)",Q="电梯",$="系统工程",O="(?<!、)自控",H=[];function V(e){return e=e.replace(/[^\w\s\u4e00-\u9fa5]/g,"").trim()}H.update=e=>H.filter((t=>{let o=function(t){let o=null,s=new RegExp(`^.*${t}.*$`,"m"),r=e.Worksheets;for(let e=1;e<=r.Count;e++){let t=r.Item(e).Name;if(s.test(t))return console.log(`找到了工作表${t}`),o=t,o}return o}(t.sheetNameKeyWords);return o?(t.sheetName=o,t.rowIndex.end=e.Worksheets.Item(o).Range("B10000").End(-4162).Row,console.log(`本工作表的最后有效数据行为${t.rowIndex.end}`),!0):(console.warn(`工作表中未找到能匹配 ${t.sheetNameKeyWords} 的sheet表`),!1)})),H.push({sheetNameKeyWords:R,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"",itemUnit:"C",itemQuantity:"D",itemUnitPrice:"E",itemSumPrice:"F"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合费用","税金"],totalKeyWords:["小计","合计","工程造价"]}},lv2:{lvKeyWords:["土石方工程","地基处理与边坡支护工程","桩基工程","基础工程","地下室及地下防水工程","砌筑工程","混凝土与钢筋混凝土工程(（不含地下）)?","金属结构工程","屋面及防水工程","建筑其他系统"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:["屋面"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:g,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"",itemUnit:"C",itemQuantity:"D",itemUnitPrice:"E",itemSumPrice:"F"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["非洁净","(?<!非)洁净"],specialRow:{costKeyWords:["零星","费用","税金"],totalKeyWords:["小计","合计","工程造价"]}},lv3:{lvKeyWords:["楼地面","隔墙","外墙","(墙)?(、)?(柱)?面","天棚","门窗","其他"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:I,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"F",itemSumPrice:"G"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:["道路","构筑物","围墙","绿化","其他","土方","其他"],specialRow:{costKeyWords:["零星","综合","税金"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:S,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置费","安装费"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["一般空调","洁净空调","通风","排烟"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:C,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["空调风","通风","排烟","空调水"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:P,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["冷冻水","热水","蒸汽","柴油"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:x,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["冷冻水","热水","蒸汽","柴油"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:b,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["给排水","消防"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["给水","排水","消火栓","自(动)?喷","气(体)?灭"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:U,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["(?<!室外)给排水","(?<!室外)消防"],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["给水","(?<!给)排水","雨水","消火栓","自(动)?喷","气(体)?灭"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:E,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:A,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:k,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["动力","照明","消防","火灾(漏电)?监控"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:B,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv2:{lvKeyWords:["动力","照明"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:D,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["通信","消防"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["综合布线","有线电视","安防","视频会议","控制中心","广播","报警","采样"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:j,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["通信","消防"],specialRow:{costKeyWords:["综合"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:["综合布线","有线电视","安防","视频会议","控制中心","广播","报警","采样"],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:Q,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"F",itemSumPrice:"G"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv2:{lvKeyWords:["非洁净","(?<!非)洁净"],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["小计","合计","总计"]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:$,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["综合"],totalKeyWords:["工程合计","小计"]}},lv2:{lvKeyWords:["设备","材料"],specialRow:{costKeyWords:["运杂","购置","安装","综合"],totalKeyWords:["小计","(?<!工程)合计","总计"]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}}),H.push({sheetNameKeyWords:O,columnIndex:{orderNumber:"A",itemIdentifier:"",itemName:"B",itemSpecs:"C",itemUnit:"D",itemQuantity:"E",itemUnitPrice:"H",itemSumPrice:"I"},rowIndex:{start:7,end:1150},section:{lv1:{lvKeyWords:[],specialRow:{costKeyWords:["运杂","购置","安装"],totalKeyWords:["工程合计","小计"]}},lv2:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv3:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv4:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}},lv5:{lvKeyWords:[],specialRow:{costKeyWords:[],totalKeyWords:[]}}}});const T={sheetName:"表2",cells:{C23:{range:"C23",row:23,column:3,selectors:["nodeName=土建室外"],attribute:"computedSumPrice"},E24:{range:"E24",row:24,column:5,selectors:["nodeName=给排水(?!设)>itemName=室外给排水工程","nodeName=给排水(?!设)>itemName=室外消防（水）工程"],attribute:"computedSumPrice"},G25:{range:"G25",row:25,column:7,selectors:["nodeName=动力(?!设)>itemName=室外动力"],attribute:"computedSumPrice"},H26:{range:"H26",row:26,column:8,selectors:["nodeName=供电(?!设)>itemName=室外"],attribute:"computedSumPrice"},J27:{range:"J27",row:27,column:10,selectors:["nodeName=通信(?!设)>itemName=室外工程"],attribute:"computedSumPrice"}},update:function(e){let t=8,o=19,s={start:"C",end:"K"},r=e.Worksheets.Item(T.sheetName);for(let l=t;l<=o;l++)for(let e=s.start.charCodeAt();e<=s.end.charCodeAt();e++){let t=l,o=String.fromCharCode(e),s="nodeName="+V(r.Range(o+6).Value2)+"(?!设)>itemName="+V(r.Range("B"+t).Value2);this.cells[o+t]={selectors:[s],attribute:"computedSumPrice"}}return console.log("report2 is :",T),T}},G={sheetName:"表3",cells:{},update:function(e){let t=8,o=19,s={start:"C",end:"T"},r=e.Worksheets.Item(G.sheetName);for(let l=t;l<=o;l++)for(let e=s.start.charCodeAt();e<=s.end.charCodeAt();e++){let t=l,o=String.fromCharCode(e),s=r.Range(o+5).Value2,i=e;for(;!s;)s=r.Range(String.fromCharCode(i--)+5).Value2;let d=r.Range("B"+t).Value2,n=r.Range(o+6).Value2;n=n.includes("安装")?"设备安装费":"设备购置费";let c="nodeName="+V(s)+"(?!设)>itemName="+V(d)+">itemName="+n;this.cells[o+t]={selectors:[c],attribute:"computedSumPrice"}}return console.log("report3 is :",G),G}},F={sheetName:"表4",cells:{},update:function(e){let t=7,o=20,s={start:"C",end:"C"},r=e.Worksheets.Item(F.sheetName);for(let l=t;l<=o;l++)for(let e=s.start.charCodeAt();e<=s.end.charCodeAt();e++){let t=l,o=String.fromCharCode(e),s="系统工程",i=r.Range("B"+t).Value2,d="nodeName="+V(s)+"(?!设)>itemName="+i;F.cells[o+t]={selectors:[d],attribute:"computedSumPrice"}}return console.log("report4 is :",F),F}},_=[T,G,F];function L(e,t){if(void 0===t||"object"!=typeof t)return void console.error("请传为loadDataByRows入正确的参数options");const o=(e,o)=>!(r(e,t.columnIndex.itemName+o)||!r(e,t.columnIndex.itemUnit+o)),s=(e,o)=>!(r(e,t.columnIndex.itemName+o)&&r(e,t.columnIndex.itemSpecs+o)||r(e,t.columnIndex.itemUnit+o)),r=(e,t)=>{let o=e.Range(t);if(null===o)return console.info(`当前单元格${t}不存在！按空值处理！`),!0;let s=o.Value();return"string"==typeof s?""===s.trim():"number"==typeof s?0===s:"object"==typeof s?null===s:void 0};function l(e,o){let s={rowIndex:o};return Object.keys(t.columnIndex).forEach((r=>{let l=t.columnIndex[r];s[r]=l?e.Range(t.columnIndex[r]+o).Value():null})),s}function i(e,o,s=t.section){let r=Object.keys(s),l=Object.keys(s[r[0]].specialRow);void 0===o&&(o=r.length);let i=0,d=!1,n=!1;for(let t=o-1;t>=0;t--){let o=s[r[t]].specialRow;if(i=t+1,l.some(((t,s)=>!!c(o[t],e)&&(1===s&&(d=!0),n=!0,!0))))break}return{lv:i+1,isSpecialRow:n,isTotalRow:d}}function d(e,t){let o=Object.keys(t);return function(e,t,o,s=0){let r=1;return Object.keys(e).some(((l,i)=>{let d=i+1;if(0===s){if(c(e[l][t],o))return r=d,!0}else if(d=s&&c(e[l][t],o))return r=d,!0;return!1})),"室外给排水工程"===o&&console.log(`${t}中找到的分级为${r}`),r}(t,Object.keys(t[o[0]])[0],e)}let n={};function c(e,t){return!!t&&(t=String(t).replace(/\s/g,""),e.some((e=>{e=e.replace(/\s/g,"");let o=n[e];return o||(o=new RegExp(`^.*${e}.*$`,"m"),n[e]=o),o.test(t)})))}const a=t.sheetName;if(!a)return new N("no-sheetname");const m=e.Worksheets.Item(a);let y=t.section,u=new N(a),W=[u],K=1;for(let p=t.rowIndex.start;p<=t.rowIndex.end;p++){let e=l(m,p);if(s(m,p)){let t=i(e.itemName,K),{lv:o,isSpecialRow:s,isTotalRow:r}=t;if(s){for(;W.length>o;)W.pop();u=W[W.length-1],r?u.addAndGetNewChild(new N({nodeName:"统计行",isItemizedProject:!0,isNeedCount:!1,isSumBefore:!0},e)):u.addAndGetNewChild(new N({nodeName:"费用行",isItemizedProject:!0},e))}else u.addAndGetNewChild(new N({nodeName:"清单行",isItemizedProject:!0},e))}else if(o(m,p))if(K=d(e.itemName,y),K===W.length)u=W[W.length-1],u=u.addAndGetNewChild(new N("分部行",e)),W.push(u);else{for(;W.length>K;)W.pop();u=W[W.length-1],u=u.addAndGetNewChild(new N("分部行",e)),W.push(u)}}return W[0]}const z=o("progress",{state:()=>({percentage:0,spendTime:0}),actions:{increment(){this.percentage++}}});function q(){return z(s)}const J=q(),M="undefined"!=typeof wps,X=M?Application:window;function Y(){if(M){let e=H.update(X);if(console.log("更新后的options",e),!e.length)return void alert("请在世源通用概算表中运行此功能！");let t=new Date,o=t.getTime();const s=new N("概算");s.initCache(),e.forEach((e=>{let t=L(X,e);t.updateComputedSumPrice(),s.addChild(t)})),t=new Date;let r=t.getTime();const l=_.map((e=>e.update(X)));let i=0,d=function(e,t,o){const s={};for(let r=0;r<t.length;r++){let l=t[r],i=l.sheetName;s[i]={};let d=l.cells;Object.keys(d).forEach((t=>{let r=0,l=d[t].attribute;d[t].selectors.forEach((t=>{let o=e.getValue(t,l);console.log(t,"找到的value值是:",o),r+=Number(o)})),o&&o(),s[i][t]=r}))}return console.log("resultData is:",s),s}(s,l,(()=>{console.log(i++)}));t=new Date;let n=t.getTime(),c=0;!function(e,t,o){let s,r=e.Worksheets;Object.keys(t).forEach((e=>{s=r.Item(e),Object.keys(t[e]).forEach((r=>{console.log("正在填写",e,r,t[e][r]),o&&o(),s.Range(r).Value2=t[e][r]}))}))}(X,d,(()=>{c++,J.percentage=c/i*100,console.log(c,"/",i,"progress.percentage is",J.percentage)})),t=new Date;let a=t.getTime();console.log(`本次收集数据运行时间为：${(r-o)/1e3}秒`),console.log(`本次查询数据运行时间为：${(n-r)/1e3}秒`),console.log(`本次填写数据运行时间为：${(a-n)/1e3}秒`),console.log(`共计运行时间为：${(a-o)/1e3}秒`),J.spendTime=(a-o)/1e3,console.log(s)}else alert("请在wps中运行!")}const Z={__name:"index",setup(e){const t=q();function o(){t.percentage=0,setTimeout((()=>{Y(),$message.info(`本次共计用时${t.spendTime}秒。`)}),100)}return l((()=>100===t.percentage?"success":100!==t.percentage?"default":void 0)),(e,t)=>(i(),d(c(K),null,{default:n((()=>[a(c(W),{justify:"space-evenly"},{default:n((()=>[a(c(m),{embedded:"",title:"概算报表",segmented:{content:!0,footer:"soft"},"header-style":"text-align: center","header-extra-style":"text-align: center","footer-style":"text-align: center"},{"header-extra":n((()=>[y(" 自动化辅助")])),footer:n((()=>[a(c(u),{strong:"",secondary:"",type:"info",onClick:o},{default:n((()=>[y("填写概算报表")])),_:1})])),action:n((()=>[])),default:n((()=>[y(" 功能：自动汇总概算表里的表1，表2，表3和表4。希望这能让你早点下班。 ")])),_:1})])),_:1})])),_:1}))}};e("default",r(Z,[["__scopeId","data-v-e92f834c"]]))}}}));
